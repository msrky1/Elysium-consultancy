jQuery(function($){$('a.edd-add-to-cart').each(function(){var $button=$(this);var $parentForm=$button.closest('form.edd_download_purchase_form');if(!$button.hasClass('js-pp-edd-fs-show-original-price')){$button.attr('data-edd-loading','');$parentForm.find('.edd_price_options input[type="radio"], .edd_price_options input[type="checkbox"]').each(function(){$(this).siblings('.edd_price_option_price').hide()})}});if('undefined'!==typeof PPEDDFS_MAIN_FOOTER.payload&&''!==PPEDDFS_MAIN_FOOTER.payload&&'undefined'!==typeof PPEDDFS_MAIN_FOOTER.key&&''!==PPEDDFS_MAIN_FOOTER.key){fastspring.builder.reset();fastspring.builder.secure(PPEDDFS_MAIN_FOOTER.payload,PPEDDFS_MAIN_FOOTER.key)}
$(document).on('submit','.edd_download_purchase_form',function(event){if('straight_to_gateway'===$(this).find('.edd_action_input').val()){event.preventDefault();var priceIDs=[];var quantities=[];var quantity;var priceID;var downloadID=$(this).find('input[name="download_id"]').val();priceID=$(this).children('input[name="edd_options[price_id][]"]').val()||!1;if(!1!==priceID){priceIDs.push(priceID)}else{priceID=$(this).find('.edd_price_options input:radio:checked').val()||!1;if(!1!==priceID){priceIDs.push(priceID)}else{$(this).find('.edd_price_options.edd_multi_mode input:checkbox:checked').each(function(){priceIDs.push($(this).val());quantity=$(this).closest('li').find('input.edd-item-quantity').val()||1;quantities.push(quantity)})}}
if(0===priceIDs.length){priceIDs=!1}
if(0===quantities.length){quantity=$(this).find('.edd-item-quantity').val()||1;quantities.push(quantity)}
$.ajax({method:'GET',url:PPEDDFS_MAIN.ajax_url,data:{action:'pp_edd_fs_get_fs_order_data_for_buy_now',edd_download_id:downloadID,edd_download_price_ids:priceIDs,edd_download_quantities:quantities,},xhrFields:{withCredentials:!0}}).done(function(response){if('undefined'!==typeof response.success&&response.success){fastspring.builder.reset();fastspring.builder.secure(response.data.payload,response.data.key);fastspring.builder.checkout()}})}})});function resetEddCartDataAndRedirect(){jQuery.ajax({method:'POST',url:PPEDDFS_MAIN.ajax_url,data:{action:'pp_edd_fs_reset_edd_cart'},xhrFields:{withCredentials:!0}}).done(function(response){if('undefined'!==typeof response.success&&response.success){if(PPEDDFS_MAIN.thank_you_page_url){window.location=PPEDDFS_MAIN.thank_you_page_url}else{window.location.reload(!0)}}})}
function resetEddBuyNowPurchaseButtons(){jQuery('.edd_download_purchase_form a.edd-add-to-cart').each(function(){var $buyNowButton=jQuery(this);var $parentForm=$buyNowButton.closest('form.edd_download_purchase_form');var $formAction=$parentForm.find('.edd_action_input');if('straight_to_gateway'===$formAction.val()){$buyNowButton.prop('disabled',!1);$buyNowButton.removeAttr('data-edd-loading')}})}
function changeEDDPurchaseLinkPriceWithFSLocalizedPrice(){jQuery('a.edd-add-to-cart').each(function(){var $button=jQuery(this);var $parentForm=$button.closest('form.edd_download_purchase_form');var label=$button.children('.edd-add-to-cart-label').html();if(label.indexOf('&nbsp;–&nbsp;')!==-1&&!$button.hasClass('js-pp-edd-fs-show-original-price')){var fsPrice=$parentForm.find('.js-pp-edd-fs-product-price').val()||!1;var eddPriceId=$parentForm.find('input[name="edd_options[price_id][]"]').val()||!1;if(eddPriceId){fsPrice=$parentForm.find('.js-pp-edd-fs-product-price[data-price-id='+eddPriceId+']').val()||!1}
if(fsPrice){var textPieces=label.split('&nbsp;–&nbsp;');textPieces[0]=fsPrice;$button.children('.edd-add-to-cart-label').text(textPieces.join(' - '))}}
$parentForm.find('.edd_price_options input[type="radio"], .edd_price_options input[type="checkbox"]').each(function(){var $option=jQuery(this);var priceId=$option.val();if(priceId&&!$button.hasClass('js-pp-edd-fs-show-original-price')){var newPrice=$parentForm.find('.js-pp-edd-fs-product-price[data-price-id='+priceId+']').val()||!1;if(newPrice){$option.siblings('.edd_price_option_price').text(newPrice).show()}}});$button.removeAttr('data-edd-loading')})}
function fastspringErrorCallback(errorCode,errorMessage){if(typeof eddCheckoutResetPurchaseButton=='function'){eddCheckoutResetPurchaseButton()}
resetEddBuyNowPurchaseButtons();jQuery(window).trigger('ppeddfsFsError',[errorCode,errorMessage])}
function fastspringPopupClosedCallback(responseObject){if(typeof eddCheckoutResetPurchaseButton=='function'){eddCheckoutResetPurchaseButton(null)}
resetEddBuyNowPurchaseButtons();if(null!==responseObject){resetEddCartDataAndRedirect()}
jQuery(window).trigger('ppeddfsFsPopupClosed',[responseObject])}
function fastspringAfterMarkupCallback(){changeEDDPurchaseLinkPriceWithFSLocalizedPrice();jQuery(window).trigger('ppeddfsAfterFsMarkup')}
function fastspringDecorateURLCallback(url){var linkerParam=null;if(window.hasOwnProperty('ga')){ga(function(){var trackers=ga.getAll();linkerParam=trackers[0].get('linkerParam')});return(linkerParam?url+'?'+linkerParam:url)}
return url}
;